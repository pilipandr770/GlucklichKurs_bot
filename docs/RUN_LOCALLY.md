# –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç—É Gl√ºckenKurs Bot

## üöÄ –®–≤–∏–¥–∫–∏–π –∑–∞–ø—É—Å–∫ (–¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–æ)

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä (FastAPI)
```powershell
# –í –æ–¥–Ω–æ–º—É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ
uvicorn app.web.server:app --host 0.0.0.0 --port 8000 --reload
```

**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞:** –í—ñ–¥–∫—Ä–∏–π—Ç–µ http://localhost:8000/health ‚Äî –º–∞—î –ø–æ–∫–∞–∑–∞—Ç–∏ `{"ok": true}`

---

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ Telegram –±–æ—Ç–∞ (–≤ —ñ–Ω—à–æ–º—É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ)
```powershell
# –í –¥—Ä—É–≥–æ–º—É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ
python -m app.bot.main
```

**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞:** –ú–∞—î –ø–æ–∫–∞–∑–∞—Ç–∏:
```
‚úÖ Reminder scheduler started
‚úÖ Bot is running...
```

---

## üîß –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –û–¥–∏–Ω —Ç–µ—Ä–º—ñ–Ω–∞–ª –∑ tmux/screen

### –î–ª—è Windows (PowerShell):
```powershell
# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä —É —Ñ–æ–Ω—ñ
Start-Job -ScriptBlock { uvicorn app.web.server:app --host 0.0.0.0 --port 8000 }

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –±–æ—Ç–∞
python -m app.bot.main
```

---

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –æ–ø–ª–∞—Ç–∏

### 1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram
```
/start
```

### 2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É "üí∞ –ö—É–ø–∏—Ç–∏ –∫—É—Ä—Å"

### 3. –ü—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å —É–º–æ–≤–∏ —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å "üí≥ –ü–µ—Ä–µ–π—Ç–∏ –¥–æ –æ–ø–ª–∞—Ç–∏"

**–©–û –í–Ü–î–ë–£–í–ê–Ñ–¢–¨–°–Ø:**
- –ë–æ—Ç –≤—ñ–¥–∫—Ä–∏—î URL: `http://localhost:8000/pay?user_id=YOUR_ID`
- –°–µ—Ä–≤–µ—Ä —Å—Ç–≤–æ—Ä–∏—Ç—å Stripe Checkout Session
- –í–∞—Å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É –æ–ø–ª–∞—Ç–∏ Stripe
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É –∫–∞—Ä—Ç–∫—É: `4242 4242 4242 4242`

### 4. –¢–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ Stripe:
```
–ù–æ–º–µ—Ä –∫–∞—Ä—Ç–∫–∏: 4242 4242 4242 4242
MM/YY: 12/34 (–±—É–¥—å-—è–∫–∞ –º–∞–π–±—É—Ç–Ω—è –¥–∞—Ç–∞)
CVC: 123
–ü–æ—à—Ç–æ–≤–∏–π —ñ–Ω–¥–µ–∫—Å: 12345
```

### 5. –ü—ñ—Å–ª—è –æ–ø–ª–∞—Ç–∏:
- –í–∏ –ø–æ–±–∞—á–∏—Ç–µ —Å—Ç–æ—Ä—ñ–Ω–∫—É "‚úÖ –î—è–∫—É—î–º–æ –∑–∞ –æ–ø–ª–∞—Ç—É!"
- Webhook —Å–ø—Ä–∞—Ü—é—î (—è–∫—â–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π)
- –°—Ç–∞—Ç—É—Å `is_paid=1` –æ–Ω–æ–≤–∏—Ç—å—Å—è –≤ –ë–î

---

## ‚ö†Ô∏è –í–∞–∂–ª–∏–≤—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### BASE_URL —É .env:
```env
# –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:
BASE_URL=http://localhost:8000

# –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω—É (–∫–æ–ª–∏ –º–∞—Ç–∏–º–µ—Ç–µ –¥–æ–º–µ–Ω):
BASE_URL=https://your-domain.com
```

**–í–ê–ñ–õ–ò–í–û:** `BASE_URL` –º–∞—î –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ –≤–∞—à –≤–µ–±-—Å–µ—Ä–≤–µ—Ä (FastAPI), –∞ –ù–ï –Ω–∞ Telegram!

---

## üåê –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω—É

### 1. –û—Ç—Ä–∏–º–∞–π—Ç–µ –ø—É–±–ª—ñ—á–Ω–∏–π –¥–æ–º–µ–Ω –∞–±–æ IP
```
–í–∞—Ä—ñ–∞–Ω—Ç–∏:
- VPS (DigitalOcean, Hetzner)
- ngrok –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è (https://ngrok.com)
- Railway / Render –¥–ª—è –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ–≥–æ —Ö–æ—Å—Ç–∏–Ω–≥—É
```

### 2. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ Stripe Webhook
```
1. –ó–∞–π–¥—ñ—Ç—å –Ω–∞ https://dashboard.stripe.com/webhooks
2. –°—Ç–≤–æ—Ä—ñ—Ç—å endpoint: https://your-domain.com/stripe/webhook
3. –û–±–µ—Ä—ñ—Ç—å –ø–æ–¥—ñ—ó: checkout.session.completed
4. –°–∫–æ–ø—ñ—é–π—Ç–µ Signing Secret ‚Üí STRIPE_WEBHOOK_SECRET —É .env
```

### 3. –û–Ω–æ–≤—ñ—Ç—å .env:
```env
BASE_URL=https://your-domain.com
```

---

## üìä –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É

### –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä:
```powershell
curl http://localhost:8000/health
# –ê–±–æ –≤—ñ–¥–∫—Ä–∏–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä—ñ
```

### –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –±–æ—Ç–∞:
```
/start –≤ Telegram
```

### –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –±–∞–∑—É –¥–∞–Ω–∏—Ö:
```powershell
python -c "from app.storage.db import get_user_by_id; print(get_user_by_id(YOUR_USER_ID))"
```

---

## üêõ Troubleshooting

### –ü–æ–º–∏–ª–∫–∞: "Connection refused" –ø—Ä–∏ /pay
**–ü—Ä–∏—á–∏–Ω–∞:** –í–µ–±-—Å–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω–∏–π  
**–†—ñ—à–µ–Ω–Ω—è:** 
```powershell
uvicorn app.web.server:app --port 8000
```

### –ü–æ–º–∏–ª–∫–∞: "TelegramBadRequest: query is too old"
**–ü—Ä–∏—á–∏–Ω–∞:** –ë–æ—Ç –±—É–≤ –≤–∏–º–∫–Ω–µ–Ω–∏–π, —Å—Ç–∞—Ä—ñ callback –∑–∞–ø–∏—Ç–∏  
**–†—ñ—à–µ–Ω–Ω—è:** –¶–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –ø—Ä–æ—Å—Ç–æ —ñ–≥–Ω–æ—Ä—É–π—Ç–µ –∞–±–æ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å /start –∑–Ω–æ–≤—É

### –û–ø–ª–∞—Ç–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –≤ Telegram –∑–∞–º—ñ—Å—Ç—å Stripe
**–ü—Ä–∏—á–∏–Ω–∞:** BASE_URL –≤–∫–∞–∑—É—î –Ω–∞ Telegram  
**–†—ñ—à–µ–Ω–Ω—è:** –ó–º—ñ–Ω—ñ—Ç—å –Ω–∞ `http://localhost:8000` —É .env

### Webhook –Ω–µ —Å–ø—Ä–∞—Ü—å–æ–≤—É—î
**–ü—Ä–∏—á–∏–Ω–∞:** Stripe –Ω–µ –º–æ–∂–µ –¥–æ—Å—Ç—É–∫–∞—Ç–∏—Å—å –¥–æ localhost  
**–†—ñ—à–µ–Ω–Ω—è:** 
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ ngrok: `ngrok http 8000`
- –ê–±–æ —Ä–æ–∑–≥–æ—Ä–Ω—ñ—Ç—å –Ω–∞ –ø—É–±–ª—ñ—á–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—ñ

---

## üìù –ö–æ—Ä–∏—Å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏

```powershell
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø–æ—Ä—Ç 8000
netstat -an | findstr :8000

# –í–±–∏—Ç–∏ –ø—Ä–æ—Ü–µ—Å –Ω–∞ –ø–æ—Ä—Ç—É 8000 (—è–∫—â–æ –∑–∞–π–Ω—è—Ç–∏–π)
Get-Process -Id (Get-NetTCPConnection -LocalPort 8000).OwningProcess | Stop-Process

# –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ª–æ–≥–∏ –±–æ—Ç–∞ (—è–∫—â–æ –∑–∞–ø—É—â–µ–Ω–∏–π —è–∫ —Ñ–æ–Ω–æ–≤–∏–π –ø—Ä–æ—Ü–µ—Å)
Get-Job | Receive-Job
```

---

## üéØ –ß–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—ñ

- [ ] –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤—Å—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ: `pip install -r requirements.txt`
- [ ] –§–∞–π–ª `.env` —Å—Ç–≤–æ—Ä–µ–Ω–∏–π —Ç–∞ –∑–∞–ø–æ–≤–Ω–µ–Ω–∏–π
- [ ] `BASE_URL=http://localhost:8000` —É .env
- [ ] –í–µ–±-—Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω–∏–π –Ω–∞ –ø–æ—Ä—Ç—É 8000
- [ ] Telegram –±–æ—Ç –∑–∞–ø—É—â–µ–Ω–∏–π
- [ ] http://localhost:8000/health –ø–æ–≤–µ—Ä—Ç–∞—î {"ok": true}
- [ ] /start –ø—Ä–∞—Ü—é—î –≤ Telegram
- [ ] –ö–Ω–æ–ø–∫–∞ "–ö—É–ø–∏—Ç–∏ –∫—É—Ä—Å" –≤—ñ–¥–∫—Ä–∏–≤–∞—î Stripe —Å—Ç–æ—Ä—ñ–Ω–∫—É

---

**–í–µ—Ä—Å—ñ—è:** 2.2.0  
**–ê–≤—Ç–æ—Ä:** Andrii Pylypchuk  
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è:** docs/DEPLOYMENT.md
